
  

JavaScript SDK Documentation
============
 This repository contains the documentation of LimePay's JavaScript SDK.
## Contents

 1. [Connecting to the API](#1-connecting)
 2. [Shoppers](#2-shoppers)
	 2.1. [Getting Shopper](#21-getting-shopper)
	 2.2[Getting all Shoppers](#22-getting-all-shoppers)
	 2.3 [Creating Shopper](#23-creating-shopper)
	 2.4 [Updating Shopper](#24-updating-shopper)
	 2.5 [Deleting Shopper](#25-deleting-shopper)
3. [Payments](#3-payments)
	3.1 [Getting Payment](#31-getting-payment)
	3.2 [Getting All Payments](#32-getting-all-payment)
4. [Fiat Payments](#4-fiat-payments)
	4.1 [Creating Fiat Payment](#43-creating-fiat-payment)
	4.2 [Sending Invoice for Payment](#43-sending-invoice-for-payment)
	4.3 [Getting Invoice Template for Payment](#44-getting-invoice-template-for-payment)
	4.4 [Getting Receipt Template for Payment](#45-getting-receipt-template-for-payment)
5. [Relayed Payments](#5-relayed-payments)
	5.1 [Creating Relayed Payment](#51-creating-relayed-payment)
6. [Objects](#6-objects)
	6.1 [Item](#item)
	6.2 [Fund Transaction Data For Fiat Payment](#fund-transaction-data-for-fiat-payment)
	6.3 [Fund Transaction Data For Relayed Payment](#fund-transaction-data-for-relayed-payment)
	6.4 [Generic Transaction](#generic-transaction)
	6.5 [Function Parameter](#function-parameter)

## 1. Connecting to the API

Installing the JavaScript SDK:

    npm install limepay

Once you have installed the sdk you need to include it in your project and connect to LimePay's API.

```javascript
const LimePay = require('limepay');
LimePay.connect({
	environment: LimePay.Environment.Production, // or LimePay.Environment.Sandbox
	apiKey: 'YOUR_API_KEY_HERE',
	secret: 'YOUR_API_SECRET_HERE'	
}); // returns promise
```

Once the `.connect` promise is being resolved you can start consuming the SDK.

## 2. Shoppers
One functionality that the SDK provides is that you can consume the Shoppers resource.

### 2.1 Getting Shopper

```javascript
LimePay.shoppers.get('shopperId') // returns promise
	.then(shopper => {})
	.catch(error => {});
```

Returns object of type [Shopper](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#shopper).

### 2.2 Getting All Shoppers

```javascript
LimePay.shoppers.getAll() // returns promise
	.then(shoppers => {})
	.catch(error => {});
```
Returns array of [Shopper](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#shopper) objects.

### 2.3 Creating Shopper

```javascript
LimePay.shoppers.create(shopperData) // returns promise
	.then(shopper => {})
	.catch(error => {});
```
Where `shopperData` is object with the following properties:
| Field 		  | Type	 | Description 				  | Required |
| --------------- | -------- | -------------------------- | -------- |
| `firstName` 	  | `string` | Shopper's first name 	  | yes	   |
| `lastName`      | `string` | Shopper's last name  	  | no	   |
| `vendor`		  | `string` | Vendor ID for which the shopper will be created. If not provided, the default organisation's vendor will be used| no|
| `email`		  | `string` | Shopper's email 			  | yes    |
| `walletAddress` | `string` | Shopper's wallet address   | yes    |

Returns object of type [Shopper](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#shopper).

### 2.4 Updating Shopper

```javascript
LimePay.shoppers.update('shopperId', shopperData) // returns promise
	.then(shopper => {})
	.catch(error => {});
```
Where `shopperData` is object with the following properties:
| Field 		  | Type	 | Description 				  | Required |
| --------------- | -------- | -------------------------- | -------- |
| `firstName` 	  | `string` | Shopper's first name 	  | no 	   |
| `lastName`      | `string` | Shopper's last name  	  | no 	   |
| `email`		  | `string` | Shopper's email 			  | no	   |
| `walletAddress` | `string` | Shopper's wallet address   | no 	   |

Returns object of type [Shopper](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#shopper).

### 2.5 Deleting Shopper

```javascript
LimePay.shoppers.delete('shopperId') // returns promise
	.then(shopper => {})
	.catch(error => {});
```
Returns response `code 200` once successfully deleting the shopper.

## 3. Payments
Through the SDK you can consume the Payments resource.

### 3.1 Getting Payment
```javascript
LimePay.payments.get('paymentId') // returns promise
	.then(payment => {})
	.catch(error => {});
```

Returns object of type [Payment](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#payment).

### 3.2 Getting All Payments
```javascript
LimePay.payments.getAll() // returns promise
	.then(payments => {})
	.catch(error => {});
```
Returns array of [Payment](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#payment). objects.

## 4. Fiat Payments

You can create Fiat Payments through the JavaScript SDK.

### 4.1 Creating Fiat Payment

```javascript
LimePay.fiatPayment.create(fiatPaymentData, signerWalletConfig) // returns promise
	.then(shopper => {})
	.catch(error => {});
```

Once executed successfully returns object of type [Payment](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#payment).

---
`signerWalletConfig` is the wallet configuration of a wallet that is marked as `signer` in the Escrow contract.
You can find more information of the properties of the `signerWalletConfig` [here](https://github.com/LimePay/docs/blob/latest/2.%20Processing-Payments.md#51-wallet-configurations).

`fiatPaymentData` is object with the following properties:
| Field | Type |Description | Required |
| -------------------- | -------- | ---------------------------------- | ---------- |
| `currency` | `string` | Currency code (ISO 4217) of the amount to be charged | yes |
| `shopper` | `string` | The ID of the shopper that will be charged | yes |
| `items` | `array` | Array of [Item](#item) objects | yes |
| `fundTxData` | `object` | [Fund Transaction Data](#fund-transaction-data-for-fiat-payment) object | yes |
| `genericTransactions`| `array` | Array of [Generic Transaction](#generic-transaction) objects | yes |

---

### 4.2 Sending Invoice for Payment

You can trigger the sending of an invoice for a specific payment to the shopper by executing the following function:
```javascript
LimePay.fiatPayment.sendInvoice('paymentId') // returns promise
	.then(() => {})
	.catch(error => {});
```
On successful request for sending the invoice you will receive status `code 200`

### 4.3 Getting Invoice Template for Payment

You can preview the invoice template that is being send to your users by executing the following function:
```javascript
LimePay.fiatPayment.getInvoice('paymentId') // returns promise
	.then((invoice) => {})
	.catch(error => {});
```
### 4.3 Getting Receipt Template for Payment

You can preview the receipt template that is being send to your users by executing the following function:
```javascript
LimePay.fiatPayment.getReceipt('paymentId') // returns promise
	.then((receipt) => {})
	.catch(error => {});
```

## 5. Relayed Payments

You can create Relayed Payments through the JavaScript SDK.

### 5.1 Creating Relayed Payment

```javascript
LimePay.relayedPayment.create(relayedPaymentData, signerWalletConfig) // returns promise
	.then(shopper => {})
	.catch(error => {});
```

Once executed successfully returns object of type [Payment](https://github.com/LimePay/docs/blob/latest/4.%20API-Documentation.md#payment).

---
`signerWalletConfig` is the wallet configuration of a wallet that is marked as `signer` in the Escrow contract.
You can find more information of the properties of the `signerWalletConfig` [here](https://github.com/LimePay/docs/blob/latest/2.%20Processing-Payments.md#51-wallet-configurations).

`relayedPaymentData` is object with the following properties:
| Field | Type |Description | Required |
| -------------------- | -------- | ---------------------------------- | ---------- |
| `shopper` | `string` | The ID of the shopper that will be charged | yes |
| `fundTxData` | `object` | [Fund TX Data](#fund-transaction-data-for-relayed-payment) object | yes |
| `genericTransactions`| `array` | Array of [Generic Transaction](#generic-transaction) objects | yes |
---

#### Generic Transaction
| Attribute | Type | Description | Required |
| -------------------- | -------- | ----------------------------------------------------- | -------- |
| `to` | `string `| Address that the transaction will be send to | yes |
| `gasPrice` | `string` | Gas price of the transaction | yes |
| `gasLimit` | `integer` | Gas limit of the transactions | yes |
| `functionName` | `string` | Name of the contract's function | yes |
| `functionParams` | `array` | Array of [Function parameter](#function-parameter]) objects. | no |

---

### 6. Objects

#### Item
| Attribute | Type | Description | Required |
| -------------------- | -------- | --------------------------------------- | -------- |
| `description` | `string` | Description of the item that is being bought. This information is displayed in the invoice. | yes |
| `lineAmount` | `decimal`| Fiat amount of the item excluding VAT amount. | yes |
| `quantity` | `integer`| Quantity of the items | yes |
---
#### Fund Transaction Data for Fiat Payment
| Attribute | Type | Description | Required |
| -------------------- | -------- | -------------------------------------------------- | -------- |
| `weiAmount` | `string` | Amount of ethers that the shopper will be funded with | yes |
| `tokenAmount` | `string` | Amount of tokens that the shopper will be funded with| no |
---
#### Fund Transaction Data for Relayed Payment
| Attribute | Type | Description | Required |
| -------------------- | -------- | -------------------------------------------------- | -------- |
| `weiAmount` | `string` | Amount of ethers that the shopper will be funded with | Yes |
---
#### Generic Transaction
| Attribute | Type | Description | Required |
| -------------------- | -------- | ----------------------------------------------------- | -------- |
| `to` | `string `| Address that the transaction will be send to | yes |
| `gasPrice` | `string` | Gas price of the transaction | yes |
| `gasLimit` | `integer` | Gas limit of the transactions | yes |
| `functionName` | `string` | Name of the contract's function | yes |
| `functionParams` | `array` | Array of [Function parameter](#function-parameter]) objects. | no |
---
### Function parameter
| Attribute | Type | Description | Required |
| -------------------- | -------- | --------------------------- | -------- |
| `value` | `any` | Value that should be passed to the function | yes |
| `type` | `string` | The solidity type of the value. For example: `bool`, `bool[]`, `address` ..... | yes |